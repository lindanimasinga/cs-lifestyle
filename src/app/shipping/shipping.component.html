<div name="scrollTo" class="mt-5 d-flex justify-content-sm-center justify-content-md-start">
    <h3 class="page-header display-5">Shipping</h3>
</div>

<div *ngIf="!isPhoneNumberVerified" class="container mt-3">
    <div class="mb-5 text-muted">We need to verify your cellphone number is correct and active before we process your order. Please
        enter your cellphone number below. </div>
    <div class="mb-3">
        <label for="cellphone">Cellphone Number</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">+27</span>
            </div>
            <input type="text" class="form-control" [(ngModel)]="userProfile.mobileNumber" name="mobileNumber"
                placeholder="cellphone" required [disabled]="isVerificationRequested">
            <div class="invalid-feedback" style="width: 100%;">
                Your cellphone number is required.
            </div>
        </div>
    </div>
    <div id="recaptcha-container" [style.visibility]="isVerificationRequested? 'hidden': 'visible'"></div>
    <div *ngIf="hasError" class="error my-3">{{errorMessage}}</div>
    <div *ngIf="isVerificationRequested" class="mb-3">
        <div class="text-muted mb-3">We have sent you a verification code to you via sms. Please enter the code below. </div>
        <label for="cellphone">Verification Code</label>
        <div class="input-group">
            <input type="text" class="form-control" [(ngModel)]="code" name="mobileNumber" placeholder="cellphone"
                required>
            <div class="invalid-feedback" style="width: 100%;">
                Your cellphone number is required.
            </div>
        </div>
        <div class="text-muted mb-3 mt-1 resend" (click)="resend()">To resend click <a>here</a></div>
    </div>

    <button *ngIf="!isVerificationRequested" class="btn btn-lg btn-block bg-dark mt-5 shadow-sm sendCode" type="submit"
        (click)="verify()">Get OTP</button>
    <button *ngIf="isVerificationRequested" class="btn btn-lg btn-block bg-dark mt-5 shadow-sm sendCode" type="submit"
        (click)="confirmCode()">Confirm</button>
</div>
<div *ngIf="isPhoneNumberVerified" class="container mt-3">
    <div class="row">
        <div class="col order-md-1">
            <form class="needs-validation" novalidate>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="firstName">First name</label>
                        <input type="text" class="form-control" [(ngModel)]="userProfile.name" name="name" value=""
                            required>
                        <div class="invalid-feedback">
                            Valid first name is required.
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="lastName">Last name</label>
                        <input type="text" class="form-control" [(ngModel)]="userProfile.description" name="surname"
                            value="" required>
                        <div class="invalid-feedback">
                            Valid last name is required.
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="cellphone">Cellphone Number</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">+27</span>
                        </div>
                        <input type="text" class="form-control" [value]="userProfile.mobileNumber" name="mobileNumber"
                            placeholder="cellphone" disabled>
                        <div class="invalid-feedback" style="width: 100%;">
                            Your cellphone number is required.
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="email">Email</label>
                    <input type="email" class="form-control" [(ngModel)]="userProfile.emailAddress" name="email"
                        placeholder="you@example.com">
                    <div class="invalid-feedback">
                        Please enter a valid email address for shipping updates.
                    </div>
                </div>

                <div class="mb-3">
                    <label for="address">Address</label>
                    <input type="text" class="form-control" [(ngModel)]="userProfile.address" name="address"
                        placeholder="1234 Main St" required>
                    <div class="invalid-feedback">
                        Please enter your shipping address.
                    </div>
                </div>

                <div class="mb-3">
                    <label for="address2">Address 2 <span class="text-muted">(Optional)</span></label>
                    <input type="text" class="form-control" id="address2" name="address2"
                        placeholder="Apartment or suite">
                </div>


                <hr class="mb-4">
                <div class="text-muted">Your contact information will be saved for us to be able to contact you to get
                    your order at your doorstep.</div>
                <button class="btn btn-lg btn-block bg-dark mt-5 shadow-sm" type="submit" (click)="startOrder()">Save
                    and Continue</button>
            </form>
        </div>
    </div>
</div>